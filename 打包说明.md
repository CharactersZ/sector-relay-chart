# Windows EXE 打包说明

## 方案一：在Windows系统上打包（推荐）

这是最简单可靠的方法：

### 步骤：

1. **将项目文件复制到Windows电脑**
   - 复制以下文件到Windows系统：
     - `sector_relay_chart.py`
     - `requirements.txt`
     - `build_windows.bat`
     - `build.spec`（可选）

2. **在Windows上安装Python**
   - 下载安装 Python 3.7+：https://www.python.org/downloads/
   - 安装时勾选 "Add Python to PATH"

3. **安装依赖**
   ```cmd
   pip install -r requirements.txt
   pip install pyinstaller
   ```

4. **运行打包脚本**
   ```cmd
   build_windows.bat
   ```

5. **获取exe文件**
   - 打包完成后，在 `dist` 目录下找到 `赛道接力图生成器.exe`
   - 这个exe文件可以独立运行，无需安装Python

---

## 方案二：使用GitHub Actions自动打包（Mac上操作）

如果你有GitHub账号，可以设置自动打包，在Mac上提交代码，GitHub自动在Windows环境打包：

### 步骤：

1. **创建GitHub仓库并推送代码**

2. **创建GitHub Actions工作流**
   - 在项目根目录创建 `.github/workflows/build.yml`
   - 内容见下方

3. **推送代码后自动打包**
   - 每次推送代码，GitHub Actions会在Windows环境自动打包
   - 在Actions页面下载打包好的exe文件

---

## 方案三：使用Docker（高级）

如果有Docker，可以在Mac上运行Windows容器打包，但配置较复杂。

---

## 方案四：使用虚拟机

在Mac上安装Windows虚拟机（Parallels Desktop、VMware Fusion等），然后在虚拟机中打包。

---

## 手动打包命令（Windows）

如果不想用批处理脚本，可以手动执行：

```cmd
pip install pyinstaller

pyinstaller --name="赛道接力图生成器" ^
    --onefile ^
    --console ^
    --hidden-import=akshare ^
    --hidden-import=pandas ^
    --hidden-import=openpyxl ^
    --collect-all akshare ^
    sector_relay_chart.py
```

或者使用spec文件：

```cmd
pyinstaller build.spec
```

---

## 打包后的文件说明

打包完成后会生成：
- `dist/赛道接力图生成器.exe` - 可执行文件（这就是你需要的）
- `build/` - 临时构建文件（可删除）
- `赛道接力图生成器.spec` - PyInstaller配置文件（可保留）

---

## 使用打包好的exe

1. 将 `赛道接力图生成器.exe` 复制到任意位置
2. 双击运行
3. 首次运行会在exe同目录生成：
   - `赛道接力图.xlsx` - Excel数据文件
   - `sector_colors.json` - 颜色映射文件

**注意**：exe文件需要网络连接来获取数据。

---

## 常见问题

### Q: exe文件很大？
A: 正常，因为包含了Python解释器和所有依赖库，通常50-100MB。

### Q: 杀毒软件报毒？
A: PyInstaller打包的exe可能被误报，这是正常现象，添加到白名单即可。

### Q: 运行exe时提示缺少DLL？
A: 可能需要安装 Visual C++ Redistributable：
   https://aka.ms/vs/17/release/vc_redist.x64.exe

### Q: 能否打包成无控制台窗口的版本？
A: 将 `build_windows.bat` 中的 `--console` 改为 `--windowed`（但会看不到输出信息）

---

## 推荐方案

**最简单**：方案一（在Windows电脑上打包）
**最自动化**：方案二（GitHub Actions）
